<!DOCTYPE html>

<html>
<head>
  <title>chap01.spec.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>chap01.spec.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-pi">"use strict"</span>;

<span class="hljs-keyword">var</span> expect = <span class="hljs-built_in">require</span>(<span class="hljs-string">'expect.js'</span>);
<span class="hljs-keyword">var</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>);

describe(<span class="hljs-string">'「計算」とは'</span>, () =&gt; {
  describe(<span class="hljs-string">'チューリング機械'</span>, () =&gt; {
    describe(<span class="hljs-string">'チューリング機械 turing machine'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>c.f. <a href="http://swizec.com/blog/a-turing-machine-in-133-bytes-of-javascript/swizec/3069">http://swizec.com/blog/a-turing-machine-in-133-bytes-of-javascript/swizec/3069</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-comment">/* #@range_begin(turing) */</span>
      <span class="hljs-keyword">var</span> machine = (code,tape,initState, endState) =&gt; {
        <span class="hljs-keyword">var</span> position = <span class="hljs-number">0</span>;                          <span class="hljs-comment">// ヘッドの位置</span>
        <span class="hljs-keyword">var</span> state = initState;                     <span class="hljs-comment">// 機械の状態</span>
        <span class="hljs-keyword">var</span> currentInstruction = <span class="hljs-literal">undefined</span>;        <span class="hljs-comment">// 実行する命令</span>
        <span class="hljs-comment">/*
         以下のwhileループにて、現在の状態が最終状態に到達するまで命令を繰り返す
         */</span>
        <span class="hljs-keyword">while</span>(state != endState) {
          <span class="hljs-keyword">var</span> cell = tape[<span class="hljs-built_in">String</span>(position)];
          <span class="hljs-keyword">if</span> (cell)
            currentInstruction = code[state][cell];
          <span class="hljs-keyword">else</span>
            currentInstruction = code[state].B;
          <span class="hljs-keyword">if</span> (!currentInstruction) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          } <span class="hljs-keyword">else</span> {
            tape[<span class="hljs-built_in">String</span>(position)] = currentInstruction.write; <span class="hljs-comment">// テープに印字する</span>
            position += currentInstruction.move;                <span class="hljs-comment">// ヘッドを動かす</span>
            state = currentInstruction.next;                    <span class="hljs-comment">// 次の状態に移る</span>
          }
        }
        <span class="hljs-keyword">return</span> tape;
      };
      <span class="hljs-comment">/* #@range_end(turing)  */</span>
      describe(<span class="hljs-string">'turingをテストする'</span>, () =&gt; {
        it(<span class="hljs-string">'入力を複製する'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(turing_example) */</span>
          <span class="hljs-keyword">var</span> code = {
            <span class="hljs-string">'q0'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"B"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q1'</span>}},
            <span class="hljs-string">'q1'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q1'</span>},
                   <span class="hljs-string">"0"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"0"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q2'</span>},
                   <span class="hljs-string">"B"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"0"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q2'</span>}},
            <span class="hljs-string">'q2'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q2'</span>},
                   <span class="hljs-string">"B"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q3'</span>}},
            <span class="hljs-string">'q3'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q3'</span>},
                   <span class="hljs-string">"0"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"0"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q3'</span>},
                   <span class="hljs-string">"B"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q4'</span>}},
            <span class="hljs-string">'q4'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"B"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q1'</span>},
                   <span class="hljs-string">"0"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"0"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q5'</span>}}
          };
          <span class="hljs-keyword">var</span> tape = {
            <span class="hljs-string">'0'</span>: <span class="hljs-string">'1'</span>,
            <span class="hljs-string">'1'</span>:<span class="hljs-string">'1'</span>,
            <span class="hljs-string">'2'</span>:<span class="hljs-string">'1'</span>
          };
          <span class="hljs-keyword">var</span> result = machine(code,<span class="hljs-comment">// 命令コード</span>
                               tape,        <span class="hljs-comment">// テープ</span>
                               <span class="hljs-string">'q0'</span>,        <span class="hljs-comment">// 初期状態</span>
                               <span class="hljs-string">'q5'</span>);       <span class="hljs-comment">// 終了状態</span>
          expect(
            result
          ).to.eql(
            [<span class="hljs-string">'1'</span>,<span class="hljs-string">'1'</span>,<span class="hljs-string">'1'</span>,<span class="hljs-string">'0'</span>,<span class="hljs-string">'1'</span>,<span class="hljs-string">'1'</span>,<span class="hljs-string">'1'</span> ]
          );
          <span class="hljs-comment">/* #@range_end(turing_example) */</span>
          next();
        });
        it(<span class="hljs-string">'最下位桁までヘッドを移動する'</span>, (next) =&gt; {
          <span class="hljs-keyword">var</span> code = {
            <span class="hljs-string">'q0'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q0'</span>},
                   <span class="hljs-string">"0"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"0"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q0'</span>},
                   <span class="hljs-string">"B"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"B"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q1'</span>}}
          };
          expect(
            machine(code,<span class="hljs-comment">// 命令コード</span>
                    [<span class="hljs-string">'0'</span>],        <span class="hljs-comment">// テープ</span>
                    <span class="hljs-string">'q0'</span>,        <span class="hljs-comment">// 初期状態</span>
                    <span class="hljs-string">'q1'</span>)       <span class="hljs-comment">// 終了状態</span>
          ).to.eql(
            [<span class="hljs-string">'0'</span>,<span class="hljs-string">'B'</span>]
          );
          expect(
            machine(code,<span class="hljs-comment">// 命令コード</span>
                    [<span class="hljs-string">'1'</span>],        <span class="hljs-comment">// テープ</span>
                    <span class="hljs-string">'q0'</span>,        <span class="hljs-comment">// 初期状態</span>
                    <span class="hljs-string">'q1'</span>)       <span class="hljs-comment">// 終了状態</span>
          ).to.eql(
            [<span class="hljs-string">'1'</span>,<span class="hljs-string">'B'</span>]
          );
          next();
        });
        it(<span class="hljs-string">'succ関数を実装する'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(turing_example_succ) */</span>
          <span class="hljs-keyword">var</span> tape = {
            <span class="hljs-string">'0'</span>:<span class="hljs-string">'1'</span>,
            <span class="hljs-string">'1'</span>:<span class="hljs-string">'0'</span>
          };
          <span class="hljs-keyword">var</span> code = {
            <span class="hljs-string">'q0'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q0'</span>},
                   <span class="hljs-string">"0"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"0"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q0'</span>},
                   <span class="hljs-string">"B"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"B"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q1'</span>}},
            <span class="hljs-string">'q1'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"0"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q1'</span>},
                   <span class="hljs-string">"0"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q2'</span>},
                   <span class="hljs-string">"B"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q3'</span>}},
            <span class="hljs-string">'q2'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q2'</span>},
                   <span class="hljs-string">"0"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"0"</span>, <span class="hljs-string">"move"</span>: -<span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q2'</span>},
                   <span class="hljs-string">"B"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"B"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q4'</span>}},
            <span class="hljs-string">'q3'</span>: {<span class="hljs-string">"1"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q4'</span>},
                   <span class="hljs-string">"0"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"0"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q4'</span>},
                   <span class="hljs-string">"B"</span>: {<span class="hljs-string">"write"</span>: <span class="hljs-string">"B"</span>, <span class="hljs-string">"move"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"next"</span>: <span class="hljs-string">'q4'</span>}}
          };
          <span class="hljs-comment">/* #@range_end(turing_example_succ) */</span>
          <span class="hljs-comment">/* #@range_begin(turing_example_succ_test) */</span>
          expect(
            machine(code,<span class="hljs-comment">// 命令コード</span>
                    tape,        <span class="hljs-comment">// テープ</span>
                    <span class="hljs-string">'q0'</span>,        <span class="hljs-comment">// 初期状態</span>
                    <span class="hljs-string">'q4'</span>)       <span class="hljs-comment">// 終了状態</span>
          ).to.eql(
            {
              <span class="hljs-string">'-1'</span>: <span class="hljs-string">'B'</span>,
              <span class="hljs-string">'0'</span>: <span class="hljs-string">'1'</span>,
              <span class="hljs-string">'1'</span>: <span class="hljs-string">'1'</span>,
              <span class="hljs-string">'2'</span>: <span class="hljs-string">'B'</span>
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>[‘1’,’1’,’B’]</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          );
          <span class="hljs-comment">/* #@range_end(turing_example_succ_test) */</span>
          next();
        });
      });
    });
  });
  describe(<span class="hljs-string">'関数型モデル'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    describe(<span class="hljs-string">'置換モデル'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      it(<span class="hljs-string">'単純なλ式の簡約'</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(succ) */</span>
        <span class="hljs-keyword">var</span> succ = (n) =&gt; {
          <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span>;
        };
        <span class="hljs-comment">/* #@range_end(succ) */</span>
        expect(
          succ(<span class="hljs-number">1</span>)
        ).to.eql(
          <span class="hljs-number">2</span>
        );
        next();
      });
      it(<span class="hljs-string">'sumsquaresとsquareの簡約'</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(sumsquares) */</span>
        <span class="hljs-keyword">var</span> sumsquares = (x,y) =&gt; {
          <span class="hljs-keyword">return</span> square(x) + square(y);
        };
        <span class="hljs-keyword">var</span> square = (x) =&gt; {
          <span class="hljs-keyword">return</span> x * x;
        };
        <span class="hljs-comment">/* #@range_end(sumsquares) */</span>
        expect(
          sumsquares(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>)
        ).to.eql(
          <span class="hljs-number">25</span>
        );
        next();
      });
      it(<span class="hljs-string">'足し算 add の簡約'</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(add) */</span>
        <span class="hljs-keyword">var</span> succ = (n) =&gt; {
          <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span>;
        };
        <span class="hljs-keyword">var</span> prev = (n) =&gt; {
          <span class="hljs-keyword">return</span> n - <span class="hljs-number">1</span>;
        };
        <span class="hljs-keyword">var</span> add = (x,y) =&gt; { <span class="hljs-comment">// add関数の定義</span>
          <span class="hljs-keyword">if</span>(y &lt; <span class="hljs-number">1</span>){
            <span class="hljs-keyword">return</span> x;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> add(succ(x), prev(y)); <span class="hljs-comment">// add関数の再帰呼び出し</span>
          }
        };
        <span class="hljs-comment">/* #@range_end(add) */</span>
        expect(
          add(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)
        ).to.eql(
          <span class="hljs-number">3</span>
        );
        next();
      });
      it(<span class="hljs-string">'チャーチ数'</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(church_numeral) */</span>
        <span class="hljs-keyword">var</span> zero = (f) =&gt; {
          <span class="hljs-keyword">return</span> (x) =&gt; {
            <span class="hljs-keyword">return</span> x;
          };
        };
        <span class="hljs-keyword">var</span> one = (f) =&gt; {
          <span class="hljs-keyword">return</span> (x) =&gt; {
            <span class="hljs-keyword">return</span> f(x);
          };
        };
        <span class="hljs-keyword">var</span> two = (f) =&gt; {
          <span class="hljs-keyword">return</span> (x) =&gt; {
            <span class="hljs-keyword">return</span> f(f(x));
          };
        };
        <span class="hljs-keyword">var</span> three = (f) =&gt; {
          <span class="hljs-keyword">return</span> (x) =&gt; {
            <span class="hljs-keyword">return</span> f(f(f(x)));
          };
        };
        <span class="hljs-keyword">var</span> succ = (n) =&gt; {
          <span class="hljs-keyword">return</span> (f) =&gt; {
            <span class="hljs-keyword">return</span> (x) =&gt; {
              <span class="hljs-keyword">return</span> f(n(f)(x));
            };
          };
        };
        <span class="hljs-keyword">var</span> add = (m) =&gt; {
          <span class="hljs-keyword">return</span> (n) =&gt; {
            <span class="hljs-keyword">return</span> (f) =&gt; {
              <span class="hljs-keyword">return</span> (x) =&gt; {
                <span class="hljs-keyword">return</span> m(f)(n(f)(x));
              };
            };
          };
        };
        <span class="hljs-comment">/*#@range_end(church_numeral) */</span>

        <span class="hljs-comment">/* #@range_begin(closure_as_counter) */</span>
        <span class="hljs-keyword">var</span> counter = (init) =&gt; {
          <span class="hljs-keyword">var</span> _init = init;
          <span class="hljs-keyword">return</span> (dummy) =&gt; {
            _init = _init + <span class="hljs-number">1</span>;
            <span class="hljs-keyword">return</span> _init;
          };
        };
        expect(one(counter(<span class="hljs-number">0</span>))()).to.eql(<span class="hljs-number">1</span>);
        expect(two(counter(<span class="hljs-number">0</span>))()).to.eql(<span class="hljs-number">2</span>);
        expect(three(counter(<span class="hljs-number">0</span>))()).to.eql(<span class="hljs-number">3</span>);
        expect(succ(one)(counter(<span class="hljs-number">0</span>))()).to.eql(<span class="hljs-number">2</span>);
        expect(succ(two)(counter(<span class="hljs-number">0</span>))()).to.eql(<span class="hljs-number">3</span>);
        expect(add(zero)(one)(counter(<span class="hljs-number">0</span>))()).to.eql(<span class="hljs-number">1</span>);
        expect(add(one)(one)(counter(<span class="hljs-number">0</span>))()).to.eql(<span class="hljs-number">2</span>);
        expect(add(one)(two)(counter(<span class="hljs-number">0</span>))()).to.eql(<span class="hljs-number">3</span>);
        expect(add(two)(three)(counter(<span class="hljs-number">0</span>))()).to.eql(<span class="hljs-number">5</span>);
        <span class="hljs-comment">/* #@range_end(closure_as_counter) */</span>
        next();
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>it(‘変数の置換規則’, (next) =&gt; {
  /<em> #@range_begin(variable_reduction) </em>/
  var foo = 3; // 変数fooを3に束縛する
  expect(
    foo        // 束縛にもとづいて変数fooを評価する
  ).to.eql(
    3
  );
  /<em> #@range_end(variable_reduction) </em>/
  next();
});</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it(<span class="hljs-string">'変数の置換規則'</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(variable_and_function) */</span>
        <span class="hljs-keyword">var</span> foo = () =&gt; {
          <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>;
        };
        expect(
          foo()
        ).to.eql(
          <span class="hljs-number">3</span>
        );
        <span class="hljs-comment">/* #@range_end(variable_and_function) */</span>
        <span class="hljs-comment">/* #@range_begin(local_variable_usage_example) */</span>
        <span class="hljs-keyword">var</span> bar = () =&gt; {
          <span class="hljs-keyword">var</span> foo = <span class="hljs-number">3</span>;     <span class="hljs-comment">// 変数fooに値3を束縛する</span>
          <span class="hljs-keyword">return</span> foo * <span class="hljs-number">10</span>; <span class="hljs-comment">// 変数fooの値を10倍にする</span>
        };
        expect(
          bar()
        ).to.eql(
          <span class="hljs-number">30</span>
        );
        <span class="hljs-comment">/* #@range_end(local_variable_usage_example) */</span>
        <span class="hljs-comment">/* #@range_begin(variable_and_closure) */</span>
        <span class="hljs-keyword">var</span> bar = () =&gt; {
          <span class="hljs-keyword">var</span> foo = <span class="hljs-number">3</span>;
          <span class="hljs-keyword">return</span> foo * <span class="hljs-number">10</span>;
        };
        <span class="hljs-keyword">var</span> baz = ((foo) =&gt; {
          <span class="hljs-keyword">return</span> foo * <span class="hljs-number">10</span>;
        });
        expect(
          bar()
        ).to.eql(
          baz(<span class="hljs-number">3</span>)          <span class="hljs-comment">// 仮引数fooに値3を束縛する</span>
        );
        <span class="hljs-comment">/* #@range_end(variable_and_closure) */</span>
        next();
      });
      it(<span class="hljs-string">'関数の置換規則'</span>, (next) =&gt; {
        <span class="hljs-keyword">var</span> succ = (n) =&gt; {
          <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span>;
        };
        <span class="hljs-keyword">var</span> prev = (n) =&gt; {
          <span class="hljs-keyword">return</span> n - <span class="hljs-number">1</span>;
        };
        <span class="hljs-keyword">var</span> add = (x, y) =&gt; { <span class="hljs-comment">// add関数の定義</span>
          <span class="hljs-keyword">if</span>(y &lt; <span class="hljs-number">1</span>){
            <span class="hljs-keyword">return</span> x;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> add(succ(x),prev(y)); <span class="hljs-comment">// add関数の再帰呼び出し</span>
          }
        };
        <span class="hljs-comment">/* #@range_begin(multiply) */</span>
        <span class="hljs-keyword">var</span> times = (count,fun,arg, memo) =&gt; {
          <span class="hljs-keyword">if</span>(count &gt; <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> times(count-<span class="hljs-number">1</span>,fun,arg, fun(arg,memo)); <span class="hljs-comment">// times関数を再帰呼出し</span>
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> fun(arg,memo);
          }
        };
        <span class="hljs-keyword">var</span> multiply = (n,m) =&gt; {
          <span class="hljs-keyword">return</span> times(m, add, n, <span class="hljs-number">0</span>); <span class="hljs-comment">// 2番目の引数にadd関数を渡している</span>
        };
        expect(
          multiply(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)
        ).to.eql(
          <span class="hljs-number">6</span>
        );
        <span class="hljs-comment">/* #@range_end(multiply) */</span>
        expect(
          multiply(<span class="hljs-number">4</span>,<span class="hljs-number">6</span>)
        ).to.eql(
          <span class="hljs-number">24</span>
        );
        expect(
          multiply(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)
        ).to.eql(
          <span class="hljs-number">1</span>
        );
        expect(
          multiply(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)
        ).to.eql(
          <span class="hljs-number">0</span>
        );
        next();
      });
    });
    describe(<span class="hljs-string">'置換モデル'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      it(<span class="hljs-string">'べき乗の定義'</span>, (next) =&gt; {
        <span class="hljs-keyword">var</span> succ = (n) =&gt; {
          <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span>;
        };
        <span class="hljs-keyword">var</span> prev = (n) =&gt; {
          <span class="hljs-keyword">return</span> n - <span class="hljs-number">1</span>;
        };
        <span class="hljs-keyword">var</span> add = (x, y) =&gt; {
          <span class="hljs-keyword">if</span>(y &lt; <span class="hljs-number">1</span>){
            <span class="hljs-keyword">return</span> x;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> add(succ(x),prev(y));
          }
        };
        <span class="hljs-keyword">var</span> times = (count,fun,arg, memo) =&gt; {
          <span class="hljs-keyword">if</span>(count &gt; <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> times(count-<span class="hljs-number">1</span>,fun,arg, fun(arg,memo));
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> fun(arg,memo);
          }
        };
        <span class="hljs-keyword">var</span> multiply = (n,m) =&gt; {
          <span class="hljs-keyword">return</span> times(m, add, n, <span class="hljs-number">0</span>);
        };
        <span class="hljs-comment">/* #@range_begin(exponential) */</span>
        <span class="hljs-keyword">var</span> exponential = (n,m) =&gt; {
          <span class="hljs-keyword">return</span> times(m, multiply, n, <span class="hljs-number">1</span>);
        };
        expect(
          exponential(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)
        ).to.eql(
          <span class="hljs-number">8</span>
        );
        <span class="hljs-comment">/* #@range_end(exponential) */</span>
        next();
      });
    });
  });
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
