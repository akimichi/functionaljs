<!DOCTYPE html>

<html>
<head>
  <title>chap02.spec.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
  <script type="text/javascript" async
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  <!-- <script type="text/x-mathjax-config"> -->
  <!--   MathJax.Hub.Config({ -->
  <!--   tex2jax: { -->
  <!--       inlineMath: [ ['$','$'], ['\\(','\\)'] ], -->
  <!--       displayMath: [ ['$$','$$'], ["\\[","\\]"] ], -->
  <!--       processEscapes: true -->
  <!--   } -->
  <!--   }); -->
  <!-- </script> -->
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>chap02.spec.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-pi">"use strict"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h1 id="-2-">第2章 なぜ関数型プログラミングが重要か</h1>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2 id="-">小目次</h2>
<div class="toc">
<ul class="toc">
  <li><a href="http://akimichi.github.io/functionaljs/chap02.spec.html#features-of-functional-programming">2.2 関数型プログラミングの特徴</a>
    <ul>
      <li><a href="http://akimichi.github.io/functionaljs/chap02.spec.html#first-class-object">ファーストクラスオブジェクトとしての関数</a></li>
      <li><a href="http://akimichi.github.io/functionaljs/chap02.spec.html#referential-transparency">参照透過性</a></li>
    </ul>
  </li>
  <li><a href="http://akimichi.github.io/functionaljs/chap02.spec.html#advantages-of-functional-programming">2.3 関数型プログラミングの利点</a>
    <ul>
      <li><a href="http://akimichi.github.io/functionaljs/chap02.spec.html#modularity">高いモジュール性</a></li>
      <li><a href="http://akimichi.github.io/functionaljs/chap02.spec.html#testability">テストが容易である</a></li>
      <li><a href="http://akimichi.github.io/functionaljs/chap02.spec.html#provable">コードの正しさを証明できる</a></li>
    </ul>
  </li>
</ul>
</div>

            </div>
            
            <div class="content"><div class='highlight'><pre>

<span class="hljs-keyword">var</span> expect = <span class="hljs-built_in">require</span>(<span class="hljs-string">'expect.js'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2 id="2-2-section-id-features-of-functional-programming-section-">2.2 <section id='features-of-functional-programming'>関数型プログラミングの特徴</section></h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>describe(<span class="hljs-string">'関数型プログラミングの特徴'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h3 id="-section-id-first-class-object-section-"><section id='first-class-object'>ファーストクラスオブジェクトとしての関数</section></h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  describe(<span class="hljs-string">'ファーストクラスオブジェクトとしての関数'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <pre><code>node&gt; <span class="hljs-keyword">var</span> zero = <span class="hljs-number">0</span>;
<span class="hljs-literal">undefined</span>
node&gt; <span class="hljs-keyword">var</span> birthday = {
...             year: <span class="hljs-number">1999</span>,
...             month: <span class="hljs-number">1</span>,
...             day: <span class="hljs-number">12</span>
...           };
<span class="hljs-literal">undefined</span>
node&gt; <span class="hljs-built_in">Math</span>.sqrt(<span class="hljs-number">2</span>)   
<span class="hljs-number">1.4142135623730951</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>
    it(<span class="hljs-string">'数値はファーストクラスオブジェクトである'</span>, (next) =&gt; {
      <span class="hljs-comment">/*  #@range_begin(number_as_first_class_citizen) */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>値を変数にバインドする</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> zero = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> name = <span class="hljs-string">"Haskell Curry"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>値をデータ構造に埋めこむ</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> birthday = {
        year: <span class="hljs-number">1999</span>,
        month: <span class="hljs-number">1</span>,
        day: <span class="hljs-number">12</span>
      };</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>関数から値を返す</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> birthYear = (birthdayObject) =&gt; {
        <span class="hljs-keyword">return</span> birthdayObject.year;
      };
      <span class="hljs-comment">/* #@range_end(number_as_first_class_citizen) */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>値を関数に渡す</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      expect(
        <span class="hljs-built_in">Math</span>.sqrt(<span class="hljs-number">2</span>)
      ).to.eql(</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>関数から値を返す</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-number">1.4142135623730951</span>
      );
      next();
    });
    it(<span class="hljs-string">'関数は変数にバインドできる'</span>, (next) =&gt; {
      <span class="hljs-comment">/* #@range_begin(function_bound_to_variable) */</span>
      <span class="hljs-keyword">var</span> succ = (n) =&gt; {
        <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span>;
      };
      <span class="hljs-comment">/* #@range_end(function_bound_to_variable) */</span>
      expect(
        succ(<span class="hljs-number">1</span>) <span class="hljs-comment">// 変数succを用いてλ式を呼びだす</span>
      ).to.eql(
        <span class="hljs-number">2</span>
      );
      next();
    });
    it(<span class="hljs-string">'関数をオブジェクトに埋めこむ'</span>, (next) =&gt; {
      <span class="hljs-comment">/* #@range_begin(function_embedded_in_object) */</span>
      <span class="hljs-keyword">var</span> math = {
        add: (n,m) =&gt; {
          <span class="hljs-keyword">return</span> n + m;
        }
      };
      expect(
        math.add(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)
      ).to.eql(
        <span class="hljs-number">3</span>
      );
      <span class="hljs-comment">/* #@range_end(function_embedded_in_object) */</span>
      next();
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p><strong>リスト 2.1</strong> forEach文によるsumの定義</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    it(<span class="hljs-string">'forEach文によるsumの定義'</span>, (next) =&gt; {
      <span class="hljs-comment">/* #@range_begin(sum_forEach) */</span>
      <span class="hljs-keyword">var</span> sum = (array) =&gt; {
        <span class="hljs-keyword">var</span> result = <span class="hljs-number">0</span>;
        array.forEach((item) =&gt; { <span class="hljs-comment">// forEachに関数を渡す</span>
          result = result + item;
        });
        <span class="hljs-keyword">return</span> result;
      };
      <span class="hljs-comment">/* #@range_end(sum_forEach)  */</span>
      expect(
        sum([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])
      ).to.eql(
        <span class="hljs-number">10</span>
      );
      next();
    });
    describe(<span class="hljs-string">'関数を返す'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>adderを定義する</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it(<span class="hljs-string">'adderを定義する'</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(adder_definition) */</span>
        <span class="hljs-keyword">var</span> adder = (n) =&gt; {
          <span class="hljs-keyword">return</span> (m) =&gt; { <span class="hljs-comment">// 関数を返す</span>
            <span class="hljs-keyword">return</span> n + m;
          };
        };
        <span class="hljs-comment">/* #@range_end(adder_definition) */</span>
        <span class="hljs-keyword">var</span> succ = adder(<span class="hljs-number">1</span>);
        expect(
          succ(<span class="hljs-number">0</span>)
        ).to.eql(
          <span class="hljs-number">1</span>
        );
        next();
      });
    });
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h3 id="-section-id-referential-transparency-section-"><section id='referential-transparency'>参照透過性</section></h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  describe(<span class="hljs-string">'参照透過性'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <blockquote>
<p>参考資料: <a href="https://ja.wikipedia.org/wiki/%E5%8F%82%E7%85%A7%E9%80%8F%E9%81%8E%E6%80%A7">Wikipediaの記事</a></p>
</blockquote>

            </div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h4 id="-">参照透過性が成立する場面</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'参照透過性が成立する場面'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>値の参照透過性</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it(<span class="hljs-string">'値の参照透過性'</span>, (next) =&gt; {
        expect(
          <span class="hljs-number">2</span> === <span class="hljs-number">2</span>
        ).to.eql(
          <span class="hljs-literal">true</span>
        );
        next();
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>変数の参照透過性</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      describe(<span class="hljs-string">'変数の参照透明性'</span>, () =&gt; {
        it(<span class="hljs-string">'変数が参照透明性を持つ場合'</span>, (next) =&gt; {
          <span class="hljs-keyword">var</span> x = <span class="hljs-number">1</span>;
          expect(
            x === x
          ).to.eql(
            x
          );
          next();
        });
        it(<span class="hljs-string">'代入は変数の参照透明性を破壊する'</span>, (next) =&gt; {
          <span class="hljs-keyword">var</span> foo = <span class="hljs-number">2</span>;
          <span class="hljs-keyword">var</span> bar = foo;
          foo = <span class="hljs-number">3</span>;
          expect(
            foo
          ).to.not.eql(
            bar
          );
          next();
        });
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>関数の参照透過性</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      describe(<span class="hljs-string">'関数の参照透明性'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>succ関数は参照透明性を持つ</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'succ関数は参照透明性を持つ'</span>, (next) =&gt; {
          <span class="hljs-keyword">var</span> succ = (x) =&gt; {
            <span class="hljs-keyword">return</span> x + <span class="hljs-number">1</span>;
          };</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <pre><code>node&gt; succ(<span class="hljs-number">1</span>) === succ(<span class="hljs-number">1</span>)
<span class="hljs-literal">true</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>          expect(
            succ(<span class="hljs-number">1</span>) === succ(<span class="hljs-number">1</span>)
          ).to.eql(
            <span class="hljs-literal">true</span>
          );
          expect(
            succ(<span class="hljs-number">1</span>) <span class="hljs-comment">// 1回目の実行</span>
          ).to.eql(
            <span class="hljs-number">2</span>
          );
          expect(
            succ(<span class="hljs-number">1</span>) <span class="hljs-comment">// 2回目の実行</span>
          ).to.eql(
            <span class="hljs-number">2</span>
          );
          next();
        });
      });
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <h4 id="-">参照透過性を破壊するもの</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'参照透過性を破壊するもの'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>可変なデータは参照透明性を破壊する</p>
<pre><code>node&gt; <span class="hljs-keyword">var</span> array = [<span class="hljs-number">1</span>];
node&gt; array
[ <span class="hljs-number">1</span> ]
node&gt; array.push(<span class="hljs-number">2</span>);
<span class="hljs-number">2</span>
node&gt; array
[ <span class="hljs-number">1</span>, <span class="hljs-number">2</span> ]
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>      it(<span class="hljs-string">'可変なデータは参照透明性を破壊する'</span>, (next) =&gt; {
        <span class="hljs-keyword">var</span> array = [<span class="hljs-number">1</span>];
        expect(
          array
        ).to.eql(
          [<span class="hljs-number">1</span>]
        );
        array.push(<span class="hljs-number">2</span>);
        expect(
          array
        ).to.eql(
          [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]
        );
        next();
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p><strong>リスト2.2</strong> 代入が参照透明性を破壊する例</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it(<span class="hljs-string">'代入が参照透明性を破壊する例'</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(assignment_breaks_referential_transparency) */</span>
        <span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> add = (y) =&gt; {
          x = x + <span class="hljs-number">1</span>; <span class="hljs-comment">// 代入で変数を更新する</span>
          <span class="hljs-keyword">return</span> x + y;
        };
        <span class="hljs-comment">/* #@range_end(assignment_breaks_referential_transparency)  */</span>
        expect(
          add(<span class="hljs-number">1</span>)
        ).to.eql(
          <span class="hljs-number">2</span>
        );
        next();
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p><strong>リスト2.3</strong> 命令的な階乗関数</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it(<span class="hljs-string">'命令的な階乗関数'</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(imperative_factorial) */</span>
        <span class="hljs-keyword">var</span> factorial = (n) =&gt; {
          <span class="hljs-comment">/* 変数resultに結果が入る */</span>
          <span class="hljs-keyword">var</span> result = <span class="hljs-number">1</span>;             
          <span class="hljs-comment">/* 変数timesは反復の回数を数える */</span>
          <span class="hljs-keyword">var</span> times = <span class="hljs-number">1</span>;              
          <span class="hljs-comment">/* while文は反復を処理する */</span>
          <span class="hljs-keyword">while</span>(times &lt; n + <span class="hljs-number">1</span>) {      
            <span class="hljs-comment">/* 変数resultを代入で更新する */</span>
            result = result * times;  
            <span class="hljs-comment">/* 変数timesを代入で更新する */</span>
            times = times + <span class="hljs-number">1</span>;        
          }
          <span class="hljs-keyword">return</span> result;
        };
        <span class="hljs-comment">/* #@range_end(imperative_factorial) */</span>
        expect(
          factorial(<span class="hljs-number">2</span>)
        ).to.eql(
          <span class="hljs-number">2</span>
        );
        expect(
          factorial(<span class="hljs-number">3</span>)
        ).to.eql(
          <span class="hljs-number">6</span>
        );
        expect(
          factorial(<span class="hljs-number">4</span>)
        ).to.eql(
          <span class="hljs-number">24</span>
        );
        next();
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>副作用と入出力</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      describe(<span class="hljs-string">'副作用と入出力'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Date.now関数は参照透明性を持たない</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'Date.now関数は参照透明性を持たない'</span>, (next) =&gt; {
          <span class="hljs-keyword">var</span> onceUponATime = <span class="hljs-built_in">Date</span>.now();
          <span class="hljs-comment">/* 時間を1秒進める */</span>
          <span class="hljs-keyword">var</span> sleep = <span class="hljs-built_in">require</span>(<span class="hljs-string">'sleep-async'</span>)();
          sleep.sleep(<span class="hljs-number">1000</span>, () =&gt; {
            expect(
              onceUponATime
            ).to.not.eql( <span class="hljs-comment">/* 等しくないことをテストしている */</span>
              <span class="hljs-built_in">Date</span>.now()
            );
          });
          next();
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>ファイル入出力が参照透明性を破壊する例</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'ファイル入出力が参照透明性を破壊する例'</span>, (next) =&gt; {
          <span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
          <span class="hljs-keyword">var</span> read = (path) =&gt; {
            <span class="hljs-keyword">var</span> readValue = fs.readFileSync(path);
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(readValue);
          };
          <span class="hljs-keyword">var</span> write = (path, n) =&gt; {
            fs.writeFileSync(path, n);
            <span class="hljs-keyword">return</span> n;
          };
          write(<span class="hljs-string">'test/resources/io.txt'</span>, <span class="hljs-number">1</span>);
          expect(
            read(<span class="hljs-string">'test/resources/io.txt'</span>)
          ).to.eql(
            <span class="hljs-number">1</span>
          );
          write(<span class="hljs-string">'test/resources/io.txt'</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// ここでファイルに値を書きこむ</span>
          expect(
            read(<span class="hljs-string">'test/resources/io.txt'</span>)
          ).to.eql(
            <span class="hljs-number">2</span>
          );
          next();
        });
      });
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <h4 id="-">参照透明性を保証する</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'参照透明性を保証する'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h5 id="-">値の参照透過性を保証する（可変なデータの排除）</h5>

            </div>
            
            <div class="content"><div class='highlight'><pre>      describe(<span class="hljs-string">'値の参照透過性を保証する（可変なデータの排除）'</span>, () =&gt;  {</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p><strong> リスト2.4</strong> 不変なデータ構造としてのオブジェクト型の実装</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'不変なデータ構造としてのオブジェクト型の実装'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(immutable_datatype) */</span>
          <span class="hljs-keyword">var</span> empty =  (_) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
          };
          <span class="hljs-keyword">var</span> get = (key, obj) =&gt; {
            <span class="hljs-keyword">return</span> obj(key);
          };
          <span class="hljs-keyword">var</span> set = (key, value, obj) =&gt; {
            <span class="hljs-keyword">return</span> (key2) =&gt; {
              <span class="hljs-keyword">if</span>(key === key2) {
                <span class="hljs-keyword">return</span> value;
              } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> get(key2,obj);
              }
            };
          };
          <span class="hljs-comment">/* #@range_end(immutable_datatype) */</span>
          next();
        });
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <h5 id="-">変数の参照透過性を保証する(代入の排除)</h5>

            </div>
            
            <div class="content"><div class='highlight'><pre>      describe(<span class="hljs-string">'変数の参照透過性を保証する(代入の排除)'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p><strong> リスト2.5</strong> 代入を使った足し算の定義</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'代入を使った足し算の定義'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(imperative_addition) */</span>
          <span class="hljs-keyword">var</span> add = (x,y) =&gt; {
            <span class="hljs-keyword">var</span> times = <span class="hljs-number">0</span>;          
            <span class="hljs-keyword">var</span> result = x;         

            <span class="hljs-comment">/* while文で反復を処理する */</span>
            <span class="hljs-keyword">while</span>(times &lt; y){       
              result = result + <span class="hljs-number">1</span>;
              times = times + <span class="hljs-number">1</span>;    
            };
            <span class="hljs-keyword">return</span> result;
          };
          <span class="hljs-comment">/* #@range_end(imperative_addition) */</span>
          expect(add(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)).to.eql(<span class="hljs-number">3</span>);
          expect(add(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)).to.eql(<span class="hljs-number">4</span>);
          expect(add(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>)).to.eql(<span class="hljs-number">5</span>);
          next();
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p><strong> リスト2.6</strong> 関数型プログラミングによる足し算の定義</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'関数型プログラミングによる足し算の定義'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(functional_addition) */</span>
          <span class="hljs-keyword">var</span> add = (x,y) =&gt; {
            <span class="hljs-keyword">if</span>(y &lt; <span class="hljs-number">1</span>){
              <span class="hljs-keyword">return</span> x;
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-comment">/* 新しい引数でadd関数を再帰的に呼び出す */</span>
              <span class="hljs-keyword">return</span> add(x + <span class="hljs-number">1</span>, y - <span class="hljs-number">1</span>); 
            }
          };
          <span class="hljs-comment">/* #@range_end(functional_addition) */</span>
          expect(add(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)).to.eql(<span class="hljs-number">3</span>);
          expect(add(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)).to.eql(<span class="hljs-number">4</span>);
          expect(add(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>)).to.eql(<span class="hljs-number">5</span>);
          next();
        });
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <h5 id="-">関数の参照透過性を保証する（副作用の分離）</h5>

            </div>
            
            <div class="content"><div class='highlight'><pre>      describe(<span class="hljs-string">'関数の参照透過性を保証する（副作用の分離）'</span>, () =&gt;  {</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p><strong>リスト2.7</strong> 副作用が分離されていないコード</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'副作用が分離されていないコード'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(age_sideeffect) */</span>
          <span class="hljs-keyword">var</span> age = (birthYear) =&gt; {
            <span class="hljs-comment">/* todayは現時点の日付データ */</span>
            <span class="hljs-keyword">var</span> today = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
            <span class="hljs-comment">/* getFullYear関数は日付データにもとづいて現時点の西暦を返す */</span>
            <span class="hljs-keyword">var</span> thisYear = today.getFullYear(); 
            <span class="hljs-keyword">return</span> thisYear - birthYear;
          };
          <span class="hljs-comment">/* #@range_end(age_sideeffect) */</span>
          next();
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p><strong>リスト2.8</strong> 副作用が分離されているコード</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'副作用が分離されているコード'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(age_without_sideeffect) */</span>
          <span class="hljs-keyword">var</span> age = (birthYear, thisYear) =&gt; {
            <span class="hljs-keyword">return</span> thisYear - birthYear;
          };
          <span class="hljs-comment">/* #@range_end(age_without_sideeffect) */</span>
          expect(
            age(<span class="hljs-number">1999</span>, (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).getFullYear())
          ).to.eql(
            <span class="hljs-number">17</span>
          );
          next();
        });
      });
    });
  });
});</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <h2 id="2-3-section-id-advantages-of-functional-programming-section-">2.3 <section id='advantages-of-functional-programming'>関数型プログラミングの利点</section></h2>
<blockquote>
<p>参考資料: <a href="https://www.google.co.jp/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwijj-fo-8zPAhWFmpQKHWI4C7UQFggcMAA&amp;url=https%3A%2F%2Fwww.cs.kent.ac.uk%2Fpeople%2Fstaff%2Fdat%2Fmiranda%2Fwhyfp90.pdf&amp;usg=AFQjCNHb88MH2uDvwjCn94-VGVe6GjAM5Q&amp;sig2=4hvyUIdaYiW5Qxc8H51Kwg">Why Functional Programming Matters</a></p>
</blockquote>

            </div>
            
            <div class="content"><div class='highlight'><pre>describe(<span class="hljs-string">'関数型プログラミングの利点'</span>, () =&gt; {
  <span class="hljs-comment">/* 下記テストで利用される関数をあらかじめ定義しておく */</span>
  <span class="hljs-keyword">var</span> compose = (f,g) =&gt; {
    <span class="hljs-keyword">return</span> (arg) =&gt; {
      <span class="hljs-keyword">return</span> f(g(arg));
    };
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <h3 id="-section-id-modularity-section-"><section id='modularity'>高いモジュール性</section></h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  describe(<span class="hljs-string">'モジュール性とは何か'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <h4 id="-">部品の汎用性</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'部品の汎用性'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p><strong>リスト2.9</strong> sumの定義</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      describe(<span class="hljs-string">'sum関数の定義'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <h5 id="foreach-sum-">forEachメソッドによるsumの定義</h5>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'forEachメソッドによるsumの定義'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(sum_in_array_while) */</span>
          <span class="hljs-keyword">var</span> sum = (array) =&gt; {
            <span class="hljs-comment">/* 結果を格納する変数 */</span>
            <span class="hljs-keyword">var</span> result = <span class="hljs-number">0</span>;
            <span class="hljs-comment">/* 反復した回数を格納する変数 */</span>
            <span class="hljs-keyword">var</span> index = <span class="hljs-number">0</span>; 
            <span class="hljs-keyword">while</span>(index &lt; array.length) {
              <span class="hljs-comment">/* 変数resultを代入で更新する */</span>
              result = result + array[index];
              <span class="hljs-comment">/* 反復回数を更新する */</span>
              index = index + <span class="hljs-number">1</span>;
            }
            <span class="hljs-keyword">return</span> result;
          };
          <span class="hljs-comment">/* #@range_end(sum_in_array_while)  */</span>
          expect(
            sum([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])
          ).to.eql(
            <span class="hljs-number">10</span>
          );
          expect(
            sum([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])
          ).to.eql(
            <span class="hljs-number">10</span>
          );
          next();
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <h5 id="reduce-sum-">reduceメソッドによるsumの定義</h5>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'reduceメソッドによるsumの定義'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(sum_in_array_reduce) */</span>
          <span class="hljs-keyword">var</span> sum = (array) =&gt; {
            <span class="hljs-keyword">return</span> array.reduce(<span class="hljs-comment">/* 第1引数に関数を渡す */</span>
              (accumulator, item) =&gt; { 
                <span class="hljs-keyword">return</span> accumulator + item; <span class="hljs-comment">/* 足し算を実行する */</span>
              },<span class="hljs-number">0</span>); <span class="hljs-comment">// 第2引数には、蓄積変数の初期値として0を渡す </span>
          };
          <span class="hljs-comment">/* #@range_end(sum_in_array_reduce)  */</span>
          expect(
            sum([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])
          ).to.eql(
            <span class="hljs-number">10</span>
          );
          next();
        });
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p><strong>リスト2.10</strong> product関数の定義</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it(<span class="hljs-string">'product関数の定義'</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(product_in_array_reduce) */</span>
        <span class="hljs-keyword">var</span> product = (array) =&gt; {
          <span class="hljs-keyword">return</span> array.reduce((accumulator, item) =&gt; {
            <span class="hljs-keyword">return</span> accumulator * item; <span class="hljs-comment">/* かけ算を実行する */</span>
          }, <span class="hljs-number">1</span>); <span class="hljs-comment">// 第2引数には、蓄積変数の初期値として1を渡す </span>
        };
        <span class="hljs-comment">/* #@range_end(product_in_array_reduce)  */</span>
        <span class="hljs-comment">/* #@range_begin(product_in_array_reduce_test) */</span>
        expect(
          product([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])
        ).to.eql(
          <span class="hljs-number">24</span>
        );
        <span class="hljs-comment">/* #@range_end(product_in_array_reduce_test)  */</span>
        next();
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p><strong>リスト2.11</strong> map関数の定義</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it(<span class="hljs-string">'map関数の定義'</span>, (next) =&gt; {
        <span class="hljs-keyword">var</span> succ = (n) =&gt; {
          <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span>;
        };
        <span class="hljs-comment">/* #@range_begin(map_in_array_reduce) */</span>
        <span class="hljs-keyword">var</span> map = (transform) =&gt; {
          <span class="hljs-keyword">return</span> (array) =&gt; {
            <span class="hljs-keyword">return</span> array.reduce((accumulator, item) =&gt; {
              <span class="hljs-keyword">return</span> accumulator.concat(transform(item));
            },[]); <span class="hljs-comment">// 蓄積変数の初期値として空の配列[]を指定する</span>
          };
        };
        <span class="hljs-comment">/* #@range_end(map_in_array_reduce)  */</span>
        expect(
          map(succ)([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>])
        ).to.eql(
          [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]
        );
        expect(</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p><strong>リスト2.12</strong> map関数のテスト</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-comment">/* #@range_begin(map_in_array_reduce_test) */</span>
          map(succ)([<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>])
          <span class="hljs-comment">/* #@range_end(map_in_array_reduce_test) */</span>
        ).to.eql(
          <span class="hljs-comment">/* #@range_begin(map_in_array_reduce_test_result) */</span>
          [<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>]
          <span class="hljs-comment">/* #@range_end(map_in_array_reduce_test_result) */</span>
        );
        next();
      });
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <h4 id="-">部品を組み合わせる</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'部品を組み合わせる'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <h5 id="-">関数適用で部品を組み合わせる</h5>

            </div>
            
            <div class="content"><div class='highlight'><pre>      describe(<span class="hljs-string">'関数適用で部品を組み合わせる'</span>, () =&gt; {
        <span class="hljs-keyword">var</span> map = (transform) =&gt; {
          <span class="hljs-keyword">return</span> (array) =&gt; {
            <span class="hljs-keyword">return</span> array.reduce((accumulator, item) =&gt; {
              <span class="hljs-keyword">return</span> accumulator.concat(transform(item));
            },[]); <span class="hljs-comment">// 蓄積変数の初期値として空の配列[]を指定する</span>
          };
        };
        <span class="hljs-keyword">var</span> sum = (array) =&gt; {
          <span class="hljs-keyword">return</span> array.reduce((accumulator, item) =&gt; { <span class="hljs-comment">// 第1引数に関数を渡す</span>
            <span class="hljs-keyword">return</span> accumulator + item;                 <span class="hljs-comment">// 足し算を実行する</span>
          },<span class="hljs-number">0</span>); <span class="hljs-comment">// 第2引数には、蓄積変数の初期値として0を渡す </span>
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p><strong>リスト2.13</strong> constant関数</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-comment">/* #@range_begin(constant) */</span>
        <span class="hljs-keyword">var</span> constant = (any) =&gt; {
          <span class="hljs-keyword">return</span> (_) =&gt; {
            <span class="hljs-keyword">return</span> any;
          };
        };
        <span class="hljs-keyword">var</span> alwaysOne = constant(<span class="hljs-number">1</span>); 
        <span class="hljs-comment">/* #@range_end(constant) */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p><strong>リスト2.14</strong> map(alwaysOne)で配列の全要素を1に変える</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-comment">/* #@range_begin(map_alwaysOne) */</span>
        expect(
          map(alwaysOne)([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>])
        ).to.eql(
          [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]
        );
        <span class="hljs-comment">/* #@range_end(map_alwaysOne) */</span>
        <span class="hljs-keyword">var</span> flip = (fun) =&gt; {
          <span class="hljs-keyword">return</span>  (x) =&gt; {
            <span class="hljs-keyword">return</span> (y) =&gt; {
              <span class="hljs-keyword">return</span> fun(y)(x);
            };
          };
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p><strong>リスト2.15</strong> 関数適用によるlength関数の定義</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'関数適用によるlength関数の定義'</span>, (next) =&gt; {
          <span class="hljs-comment">/* #@range_begin(array_length) */</span>
          <span class="hljs-keyword">var</span> length = (array) =&gt; {
            <span class="hljs-keyword">return</span> sum(map(alwaysOne)(array));
          };
          <span class="hljs-comment">/* #@range_end(array_length)  */</span>
          expect(
            length([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>])
          ).to.eql(
            <span class="hljs-number">3</span>
          );
          next();
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <h5 id="-">関数合成による処理の合成</h5>

            </div>
            
            <div class="content"><div class='highlight'><pre>        describe(<span class="hljs-string">'関数合成による処理の合成'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p><strong>リスト2.16</strong> 関数の合成</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-comment">/* #@range_begin(function_compose) */</span>
          <span class="hljs-keyword">var</span> compose = (f,g) =&gt; {
            <span class="hljs-keyword">return</span> (arg) =&gt; {
              <span class="hljs-keyword">return</span> f(g(arg));
            };
          };
          <span class="hljs-comment">/* #@range_end(function_compose)  */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p><strong>リスト2.17</strong> 関数合成によるlength関数の定義（ポイントフリースタイル）</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          it(<span class="hljs-string">'関数合成によるlength関数の定義（ポイントフリースタイル）'</span>, (next) =&gt; {
            <span class="hljs-comment">/* #@range_begin(array_length_in_composition_with_point_free_style) */</span>
            <span class="hljs-keyword">var</span> length = compose(sum,map(alwaysOne));
            <span class="hljs-comment">/* #@range_end(array_length_in_composition_with_point_free_style)  */</span>
            expect(
              length([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>])
            ).to.eql(
              <span class="hljs-number">3</span>
            );
            next();
          });</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p><strong>リスト2.18</strong> 関数合成によるlength関数の定義（引数を明示したスタイル）</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          it(<span class="hljs-string">'関数合成によるlength関数の定義（引数を明示したスタイル）'</span>, (next) =&gt; {
            <span class="hljs-comment">/* #@range_begin(array_length_in_composition) */</span>
            <span class="hljs-keyword">var</span> length = (array) =&gt; { <span class="hljs-comment">// 引数が配列であることを明示する</span>
              <span class="hljs-keyword">return</span> compose(sum,map(alwaysOne))(array);
            };
            <span class="hljs-comment">/* #@range_end(array_length_in_composition)  */</span>
            expect(
              length([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>])
            ).to.eql(
              <span class="hljs-number">3</span>
            );
            next();
          });
        });
      });</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <h5 id="-">関数による遅延評価</h5>

            </div>
            
            <div class="content"><div class='highlight'><pre>      describe(<span class="hljs-string">'関数による遅延評価'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>評価戦略の種類</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        describe(<span class="hljs-string">'評価戦略の種類'</span>, () =&gt; {
          <span class="hljs-keyword">var</span> map = (transform) =&gt; {
            <span class="hljs-keyword">return</span> (array) =&gt; {
              <span class="hljs-keyword">return</span> array.reduce((accumulator, item) =&gt; {
                <span class="hljs-keyword">return</span> accumulator.concat(transform(item));
              },[]); 
            };
          };
          <span class="hljs-keyword">var</span> sum = (array) =&gt; {
            <span class="hljs-keyword">return</span> array.reduce((accumulator, item) =&gt; { 
              <span class="hljs-keyword">return</span> accumulator + item;                
            },<span class="hljs-number">0</span>); 
          };
          <span class="hljs-keyword">var</span> constant = (any) =&gt; {
            <span class="hljs-keyword">return</span> (_) =&gt; {
              <span class="hljs-keyword">return</span> any;
            };
          };
          <span class="hljs-keyword">var</span> alwaysOne = constant(<span class="hljs-number">1</span>); 
          <span class="hljs-keyword">var</span> length = compose(sum,map(alwaysOne));</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p><strong>リスト2.19</strong> 正格評価の例</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          it(<span class="hljs-string">'正格評価の例'</span>, (next) =&gt; {
            expect(
              <span class="hljs-comment">/* #@range_begin(strict_evaluation) */</span>
              length([<span class="hljs-number">1</span>,<span class="hljs-number">1</span>+<span class="hljs-number">1</span>])
              <span class="hljs-comment">/* #@range_end(strict_evaluation) */</span>
            ).to.eql(
              <span class="hljs-comment">/* #@range_begin(strict_evaluation_result) */</span>
              <span class="hljs-number">2</span>
              <span class="hljs-comment">/* #@range_end(strict_evaluation_result) */</span>
            );
            next();
          });</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p><strong>リスト2.20</strong> 遅延評価の例</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          it(<span class="hljs-string">'遅延評価の例'</span>, (next) =&gt; {
            expect(
              <span class="hljs-comment">/* #@range_begin(lazy_evaluation) */</span>
              length([<span class="hljs-number">1</span>,(_) =&gt; {
                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>+<span class="hljs-number">1</span>; 
              }])
              <span class="hljs-comment">/* #@range_end(lazy_evaluation) */</span>
            ).to.eql(
              <span class="hljs-comment">/* #@range_begin(lazy_evaluation_result) */</span>
              <span class="hljs-number">2</span>
              <span class="hljs-comment">/* #@range_end(lazy_evaluation_result) */</span>
            );
            next();
          });
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <h5 id="-">遅延評価によるストリーム</h5>

            </div>
            
            <div class="content"><div class='highlight'><pre>        describe(<span class="hljs-string">'遅延評価によるストリーム'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p><strong>リスト2.21</strong> ストリームの例</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          it(<span class="hljs-string">'ストリームの例'</span>, (next) =&gt; {
            <span class="hljs-comment">/* #@range_begin(stream_example) */</span>
            <span class="hljs-keyword">var</span> aStream = [<span class="hljs-number">1</span>, (_) =&gt; { <span class="hljs-comment">// 後尾は無名関数で表現する</span>
              <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;
            }];
            <span class="hljs-comment">/* #@range_end(stream_example) */</span>
            expect(
              aStream[<span class="hljs-number">0</span>] <span class="hljs-comment">// ストリームの先頭要素を取得する</span>
            ).to.eql(
              <span class="hljs-number">1</span>
            );
            expect(
              aStream[<span class="hljs-number">1</span>]() <span class="hljs-comment">// 関数適用でストリームの後尾を取り出す</span>
            ).to.eql(
              <span class="hljs-number">2</span>
            );
            next();
          });
          describe(<span class="hljs-string">'無限ストリームを作る'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p><strong>リスト2.22</strong> enumFrom関数 </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> succ = (n) =&gt; {
              <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span>;
            };
            <span class="hljs-comment">/* #@range_begin(enumFrom) */</span>
            <span class="hljs-keyword">var</span> enumFrom = (n) =&gt; {
              <span class="hljs-keyword">return</span> [n, (_) =&gt; { <span class="hljs-comment">// ストリームを返す</span>
                <span class="hljs-keyword">return</span> enumFrom(succ(n));
              }];
            };
            <span class="hljs-comment">/* #@range_end(enumFrom) */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p><strong>リスト2.23</strong> 無限の偶数列を作る</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            it(<span class="hljs-string">'無限の偶数列を作る'</span>, (next) =&gt; {
              <span class="hljs-comment">/* #@range_begin(evenStream) */</span>
              <span class="hljs-keyword">var</span> evenFrom = (n) =&gt; {
                <span class="hljs-keyword">return</span> [n, (_) =&gt; {
                  <span class="hljs-keyword">return</span> evenFrom(n + <span class="hljs-number">2</span>);
                }];
              };
              <span class="hljs-keyword">var</span> evenStream = evenFrom(<span class="hljs-number">2</span>); 
              <span class="hljs-comment">/* #@range_end(evenStream) */</span>
              <span class="hljs-keyword">var</span> take = (n, astream) =&gt; {
                <span class="hljs-keyword">if</span>(n === <span class="hljs-number">1</span>) {
                  <span class="hljs-keyword">return</span> astream[<span class="hljs-number">0</span>];
                } <span class="hljs-keyword">else</span> {
                  <span class="hljs-keyword">return</span> [astream[<span class="hljs-number">0</span>]].concat(take(n-<span class="hljs-number">1</span>, astream[<span class="hljs-number">1</span>]()));
                }
              };
              expect(
                take(<span class="hljs-number">3</span>, evenStream)
              ).to.eql(
                [<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>]
              );
              next();
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p><strong>リスト2.24</strong> iterate関数 </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-comment">/* #@range_begin(stream_iterate) */</span>
            <span class="hljs-keyword">var</span> iterate = (init) =&gt; {  <span class="hljs-comment">// 先頭の値を渡す</span>
              <span class="hljs-keyword">return</span> (step) =&gt; {       <span class="hljs-comment">// 次の値との差を計算する関数を渡す</span>
                <span class="hljs-keyword">return</span> [init, (_) =&gt; { <span class="hljs-comment">// ストリーム型を返す</span>
                  <span class="hljs-keyword">return</span> iterate(step(init))(step);
                }];
              };
            };
            <span class="hljs-comment">/* #@range_end(stream_iterate) */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p><strong>リスト2.25</strong> 無限ストリームの例</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            it(<span class="hljs-string">'無限の偶数列'</span>, (next) =&gt; {
              <span class="hljs-keyword">var</span> succ = (n) =&gt; {
                <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span>;
              };
              <span class="hljs-comment">/* #@range_begin(enumFrom_by_iterate) */</span>
              <span class="hljs-keyword">var</span> enumFrom = (n) =&gt; {
                <span class="hljs-keyword">return</span> iterate(n)(succ);
              };</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>自然数列を定義する</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              <span class="hljs-keyword">var</span> naturals = enumFrom(<span class="hljs-number">1</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>偶数列を定義する</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              <span class="hljs-keyword">var</span> twoStep = (n) =&gt; {
                <span class="hljs-keyword">return</span> n + <span class="hljs-number">2</span>;
              };
              <span class="hljs-keyword">var</span> evenStream = iterate(<span class="hljs-number">2</span>)(twoStep);
              <span class="hljs-comment">/* #@range_end(enumFrom_by_iterate) */</span>
              next();
            });
            it(<span class="hljs-string">'ストリームを加工する'</span>, (next) =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p><strong>リスト2.26</strong> ストリームのfilter関数</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              <span class="hljs-comment">/* #@range_begin(stream_filter) */</span>
              <span class="hljs-keyword">var</span> filter = (predicate) =&gt; {
                <span class="hljs-keyword">return</span> (aStream) =&gt; {
                  <span class="hljs-comment">/* ストリームの先頭要素を取り出す */</span>
                  <span class="hljs-keyword">var</span> head = aStream[<span class="hljs-number">0</span>];
                  <span class="hljs-comment">/* 先頭要素が条件に合致する場合 */</span>
                  <span class="hljs-keyword">if</span>(predicate(head) === <span class="hljs-literal">true</span>) { 
                    <span class="hljs-keyword">return</span> [head, (_) =&gt; {
                      <span class="hljs-keyword">return</span> filter(predicate)(aStream[<span class="hljs-number">1</span>]());
                    }];
                  } <span class="hljs-keyword">else</span> {                       
                    <span class="hljs-comment">/* 先頭要素が条件に合致しない場合 */</span>
                    <span class="hljs-keyword">return</span> filter(predicate)(aStream[<span class="hljs-number">1</span>]());
                  }
                };
              };
              <span class="hljs-comment">/* #@range_end(stream_filter) */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p><strong>リスト2.27</strong>filter関数で無限の偶数列を作る</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              <span class="hljs-comment">/* #@range_begin(evenStream_by_filter) */</span>
              <span class="hljs-keyword">var</span> even = (n) =&gt; {
                <span class="hljs-keyword">return</span> (n % <span class="hljs-number">2</span>) === <span class="hljs-number">0</span>; 
              };
              <span class="hljs-keyword">var</span> evenStream = filter(even)(enumFrom(<span class="hljs-number">1</span>));
              <span class="hljs-comment">/* #@range_end(evenStream_by_filter) */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p><strong>リスト2.28</strong> ストリームのelemAt関数</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              <span class="hljs-comment">/* #@range_begin(stream_elemAt) */</span>
              <span class="hljs-keyword">var</span> elemAt = (n) =&gt; {
                <span class="hljs-keyword">return</span> (aStream) =&gt; {
                  <span class="hljs-keyword">if</span>(n === <span class="hljs-number">1</span>) {
                    <span class="hljs-keyword">return</span> aStream[<span class="hljs-number">0</span>];
                  } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">return</span> elemAt(n-<span class="hljs-number">1</span>)(aStream[<span class="hljs-number">1</span>]());
                  };
                };
              };
              <span class="hljs-comment">/* #@range_end(stream_elemAt) */</span>
              expect(
                elemAt(<span class="hljs-number">1</span>)(evenStream)
              ).to.eql(
                <span class="hljs-number">2</span>
              );
              expect(
                elemAt(<span class="hljs-number">2</span>)(evenStream)
              ).to.eql(
                <span class="hljs-number">4</span>
              );</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p><strong>リスト2.29</strong> 3番目の偶数を求める</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              expect(
                <span class="hljs-comment">/* #@range_begin(third_element_of_evenStream) */</span>
                elemAt(<span class="hljs-number">3</span>)(evenStream)
                <span class="hljs-comment">/* #@range_end(third_element_of_evenStream) */</span>
              ).to.eql(
                <span class="hljs-comment">/* #@range_begin(third_element_of_evenStream_result) */</span>
                <span class="hljs-number">6</span>
                <span class="hljs-comment">/* #@range_end(third_element_of_evenStream_result) */</span>
              );
              next();
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p><strong>リスト2.30</strong> 配列のelemAt関数</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            it(<span class="hljs-string">'配列のelemAt関数'</span>, (next) =&gt; {
              <span class="hljs-comment">/* #@range_begin(array_elemAt) */</span>
              <span class="hljs-keyword">var</span> elemAt = (n) =&gt; {
                <span class="hljs-keyword">return</span> (anArray) =&gt; {
                  <span class="hljs-keyword">if</span>(n === <span class="hljs-number">1</span>) {
                    <span class="hljs-keyword">return</span> anArray[<span class="hljs-number">0</span>];
                  } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">var</span> tail = anArray.slice(<span class="hljs-number">1</span>,anArray.length);
                    <span class="hljs-keyword">return</span> elemAt(n-<span class="hljs-number">1</span>)(tail);
                  };
                };
              };
              <span class="hljs-comment">/* #@range_end(array_elemAt) */</span>
              expect(</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p><strong>リスト2.31</strong> 4番目の偶数を求める</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-comment">/* #@range_begin(fourth_element_of_evenArray) */</span>
                elemAt(<span class="hljs-number">4</span>)([<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>])
                <span class="hljs-comment">/* #@range_end(fourth_element_of_evenArray) */</span>
              ).to.eql(
                <span class="hljs-comment">/* #@range_begin(fourth_element_of_evenArray_result) */</span>
                <span class="hljs-literal">undefined</span>
                <span class="hljs-comment">/* #@range_end(fourth_element_of_evenArray_result) */</span>
              );
              next();
            });
          });
        });
      });
    });
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <h3 id="-section-id-testability-section-"><section id='testability'>テストが容易である</section></h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  describe(<span class="hljs-string">'テストが容易である'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p><strong>リスト2.32</strong> 単体テストの書き方の例</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    it(<span class="hljs-string">'単体テストの書き方の例'</span>, (next) =&gt; {
      <span class="hljs-keyword">var</span> succ = (n) =&gt; {
        <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span>;
      };
      <span class="hljs-comment">/* #@range_begin(expect_example) */</span>
      expect(
        succ(<span class="hljs-number">1</span>) <span class="hljs-comment">// テストしたい式を書く</span>
      ).to.eql(
        <span class="hljs-number">2</span>       <span class="hljs-comment">// 期待する結果を書く</span>
      );
      <span class="hljs-comment">/* #@range_end(expect_example) */</span>
      next();
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p><strong>リスト2.33</strong> 参照透過性のない関数の単体テスト</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    it(<span class="hljs-string">"参照透過性のない関数の単体テスト"</span>, (next) =&gt; {
      <span class="hljs-comment">/* #@range_begin(winner_with_sideeffect) */</span>
      <span class="hljs-keyword">var</span> winner = (playerL, playerR) =&gt; {
        <span class="hljs-keyword">if</span>(playerR.score &gt; playerL.score) {
          <span class="hljs-built_in">console</span>.log(playerR.name + <span class="hljs-string">"が勝者です"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(playerR.score &lt; playerL.score) {
          <span class="hljs-built_in">console</span>.log(playerL.name + <span class="hljs-string">"が勝者です"</span>);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"引き分けです"</span>);
        }
      }; 
      <span class="hljs-comment">/* #@range_end(winner_with_sideeffect) */</span>
      <span class="hljs-keyword">var</span> playerA = {
        name: <span class="hljs-string">'a'</span>,
        score: <span class="hljs-number">10</span>
      };
      <span class="hljs-keyword">var</span> playerB = {
        name: <span class="hljs-string">'b'</span>,
        score: <span class="hljs-number">20</span>
      };
      next();
    });
    describe(<span class="hljs-string">'副作用を分離する'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p><strong>リスト2.34</strong> winner関数の分離</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it(<span class="hljs-string">"winner関数の分離"</span>, (next) =&gt; {
        <span class="hljs-comment">/* #@range_begin(winner_without_sideeffect) */</span>
        <span class="hljs-comment">/* 勝者を判定する */</span>
        <span class="hljs-keyword">var</span> judge = (playerL, playerR) =&gt; {
          <span class="hljs-keyword">if</span>(playerL.score &gt; playerR.score) {
            <span class="hljs-keyword">return</span> playerL;
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(playerL.score &lt; playerR.score) {
            <span class="hljs-keyword">return</span> playerR;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
          }
        }; 
        <span class="hljs-comment">/* 勝者を告げる文字列を生成する */</span>
        <span class="hljs-keyword">var</span> announce = (winner) =&gt; {
          <span class="hljs-keyword">if</span>(winner) {
            <span class="hljs-keyword">return</span> winner.name + <span class="hljs-string">"が勝者です"</span>;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"引き分けです"</span>;
          }
        };
        <span class="hljs-comment">/* 勝者を表示する */</span>
        <span class="hljs-keyword">var</span> displayWinner = (winner) =&gt; {
          <span class="hljs-built_in">console</span>.log(announce(winner));
        };
        <span class="hljs-comment">/* #@range_end(winner_without_sideeffect) */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p><strong>リスト2.35</strong> 副作用のない関数のテスト</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-comment">/* #@range_begin(announce_winner) */</span>
        <span class="hljs-keyword">var</span> socrates = {
          name: <span class="hljs-string">'ソクラテス'</span>,
          score: <span class="hljs-number">10</span>
        };
        <span class="hljs-keyword">var</span> plato = {
          name: <span class="hljs-string">'プラトン'</span>,
          score: <span class="hljs-number">20</span>
        };
        <span class="hljs-comment">/* 純粋な関数をテストする */</span>
        expect(
          announce(judge(socrates, plato))
        ).to.eql(
          <span class="hljs-string">"プラトンが勝者です"</span>
        );
        <span class="hljs-comment">/* #@range_end(announce_winner) */</span>
        next();
      });
    });
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <h3 id="-section-id-provable-section-"><section id='provable'>コードの正しさを証明できる</section></h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>  describe(<span class="hljs-string">'コードの正しさを証明できる'</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <h4 id="-">プロパティテストで正しさを検証する</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'プロパティテストで正しさを検証する'</span>, () =&gt; {
      <span class="hljs-keyword">var</span> adder = (m) =&gt; {
        <span class="hljs-keyword">return</span> (n) =&gt; {
          <span class="hljs-keyword">return</span> m + n;
        };
      };
      <span class="hljs-keyword">var</span> succ = adder(<span class="hljs-number">1</span>);
      <span class="hljs-keyword">var</span> iterate = (step) =&gt; {
        <span class="hljs-keyword">return</span> (init) =&gt; {
          <span class="hljs-keyword">return</span> [init, (_) =&gt; {
            <span class="hljs-keyword">return</span> iterate(step)(step(init));
          }];
        };
      };
      <span class="hljs-keyword">var</span> enumFrom = (from) =&gt; {
        <span class="hljs-keyword">return</span> iterate(succ)(from);
      };
      it(<span class="hljs-string">'succ関数の性質テスト'</span>, (next) =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p><strong>リスト2.39</strong> プロパティテストのための関数</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-comment">/* #@range_begin(succ_property) */</span>
        <span class="hljs-comment">/* ストリームのmap関数 */</span>
        <span class="hljs-keyword">var</span> map = (transform) =&gt; {
          <span class="hljs-keyword">return</span> (aStream) =&gt; {
            <span class="hljs-keyword">var</span> head = aStream[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">return</span> [transform(head), (_) =&gt; {
              <span class="hljs-keyword">return</span> map(transform)(aStream[<span class="hljs-number">1</span>]());
            }];
          };
        };
        <span class="hljs-comment">/* ストリームの先頭から引数n分だけ取り出すtake関数 */</span>
        <span class="hljs-keyword">var</span> take = (n) =&gt; {
          <span class="hljs-keyword">return</span> (aStream) =&gt; {
            <span class="hljs-keyword">if</span>(n === <span class="hljs-number">0</span>) {
              <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">return</span> [aStream[<span class="hljs-number">0</span>], (_) =&gt; {
                <span class="hljs-keyword">return</span> take(n-<span class="hljs-number">1</span>)(aStream[<span class="hljs-number">1</span>]());
              }];
            }
          };
        };
        <span class="hljs-comment">/* ストリームの全ての要素がtrueであるかを判定するall関数 */</span>
        <span class="hljs-keyword">var</span> all = (aStream) =&gt; {
          <span class="hljs-keyword">var</span> allHelper = (aStream, accumulator) =&gt; {
            <span class="hljs-keyword">var</span> head = aStream[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">var</span> newAccumulator = accumulator &amp;&amp; head;
            <span class="hljs-keyword">if</span>(aStream[<span class="hljs-number">1</span>]() === <span class="hljs-literal">null</span>){
              <span class="hljs-keyword">return</span> newAccumulator;
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">return</span> allHelper(aStream[<span class="hljs-number">1</span>](), newAccumulator);
            } 
          };
          <span class="hljs-keyword">return</span> allHelper(aStream, <span class="hljs-literal">true</span>);
        };
        <span class="hljs-comment">/* 検証の対象となる命題 */</span>
        <span class="hljs-keyword">var</span> proposition = (n) =&gt; {
          <span class="hljs-keyword">return</span> succ(<span class="hljs-number">0</span>) + succ(n) === succ(succ(n));
        };
        <span class="hljs-comment">/* #@range_end(succ_property) */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p><strong>リスト2.40</strong> succ関数のプロパティテスト</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-comment">/* #@range_begin(succ_property_test) */</span>
        <span class="hljs-comment">/* 100個の整数について命題が正しいかをテストする */</span>
        expect(
          all(
            take(<span class="hljs-number">100</span>)(
              map(proposition)(enumFrom(<span class="hljs-number">0</span>))
            )
          )
        ).to.eql(
          <span class="hljs-literal">true</span>
        );
        <span class="hljs-comment">/* #@range_end(succ_property_test) */</span>
        next();
      });
    });
  });
});</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p><a href="index.html">目次に戻る</a> <a href="chap03.spec.html">次章に移る</a> </p>

            </div>
            
        </li>
        
    </ul>
  <!-- <div id="footer">  目次に戻る。 </div> -->
  <!-- </div> -->
</body>
</html>
